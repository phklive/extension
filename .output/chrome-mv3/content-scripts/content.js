var content=function(){"use strict";var L=Object.defineProperty;var A=(l,s,r)=>s in l?L(l,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[s]=r;var c=(l,s,r)=>A(l,typeof s!="symbol"?s+"":s,r);var p,v;function l(e){return e}const s={matches:["*://*/*"],runAt:"document_start",async main(){const e=document.createElement("script");e.src=chrome.runtime.getURL("injected.js"),e.onload=()=>e.remove(),(document.head||document.documentElement).appendChild(e),chrome.runtime.onMessage.addListener((t,n,i)=>{if(t.type==="CONNECT_WALLET")return I(i),!0}),window.addEventListener("message",t=>{if(t.origin===window.location.origin&&t.data.type==="WALLET_CONNECTION_RESULT"){const n=t.data.payload;r&&(r(n),r=null)}})}};let r=null;async function I(e){r=e,window.postMessage({type:"CONNECT_WALLET_REQUEST",source:"metamask-extension-content"},"*"),setTimeout(()=>{r&&(r({success:!1,error:"Connection timeout"}),r=null)},1e4)}const u=(v=(p=globalThis.browser)==null?void 0:p.runtime)!=null&&v.id?globalThis.browser:globalThis.chrome;function h(e,...t){}const b={debug:(...e)=>h(console.debug,...e),log:(...e)=>h(console.log,...e),warn:(...e)=>h(console.warn,...e),error:(...e)=>h(console.error,...e)},g=class g extends Event{constructor(t,n){super(g.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=n}};c(g,"EVENT_NAME",w("wxt:locationchange"));let E=g;function w(e){var t;return`${(t=u==null?void 0:u.runtime)==null?void 0:t.id}:content:${e}`}function N(e){let t,n;return{run(){t==null&&(n=new URL(location.href),t=e.setInterval(()=>{let i=new URL(location.href);i.href!==n.href&&(window.dispatchEvent(new E(i,n)),n=i)},1e3))}}}const d=class d{constructor(t,n){c(this,"isTopFrame",window.self===window.top);c(this,"abortController");c(this,"locationWatcher",N(this));c(this,"receivedMessageIds",new Set);this.contentScriptName=t,this.options=n,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return u.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,n){const i=setInterval(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearInterval(i)),i}setTimeout(t,n){const i=setTimeout(()=>{this.isValid&&t()},n);return this.onInvalidated(()=>clearTimeout(i)),i}requestAnimationFrame(t){const n=requestAnimationFrame((...i)=>{this.isValid&&t(...i)});return this.onInvalidated(()=>cancelAnimationFrame(n)),n}requestIdleCallback(t,n){const i=requestIdleCallback((...o)=>{this.signal.aborted||t(...o)},n);return this.onInvalidated(()=>cancelIdleCallback(i)),i}addEventListener(t,n,i,o){var a;n==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),(a=t.addEventListener)==null||a.call(t,n.startsWith("wxt:")?w(n):n,i,{...o,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),b.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:d.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){var a,S,T;const n=((a=t.data)==null?void 0:a.type)===d.SCRIPT_STARTED_MESSAGE_TYPE,i=((S=t.data)==null?void 0:S.contentScriptName)===this.contentScriptName,o=!this.receivedMessageIds.has((T=t.data)==null?void 0:T.messageId);return n&&i&&o}listenForNewerScripts(t){let n=!0;const i=o=>{if(this.verifyScriptStartedEvent(o)){this.receivedMessageIds.add(o.data.messageId);const a=n;if(n=!1,a&&(t!=null&&t.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",i),this.onInvalidated(()=>removeEventListener("message",i))}};c(d,"SCRIPT_STARTED_MESSAGE_TYPE",w("wxt:content-script-started"));let f=d;function F(){}function m(e,...t){}const C={debug:(...e)=>m(console.debug,...e),log:(...e)=>m(console.log,...e),warn:(...e)=>m(console.warn,...e),error:(...e)=>m(console.error,...e)};return(async()=>{try{const{main:e,...t}=s,n=new f("content",t);return await e(n)}catch(e){throw C.error('The content script "content" crashed on startup!',e),e}})()}();
content;
